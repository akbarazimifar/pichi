parameters:
  name: ''
  cwd: ''
  src: ''
  extraArgs: ''

steps:
  - bash: mkdir -p ${{ parameters.cwd }}
    displayName: "Prepare cwd for building ${{ parameters.name }}"
  - task: CMake@1
    displayName: "Generate building files for ${{ parameters.name }}"
    inputs:
      cmakeArgs: $(TOOLCHAIN_ARGS) ${{ parameters.extraArgs }} ${{ parameters.src }}
      cwd: ${{ parameters.cwd }}
  - task: CMake@1
    displayName: "Build and install for ${{ parameters.name }}"
    inputs:
      cmakeArgs:
        --build ${{ parameters.cwd }} -j $(PARALLEL) --target install
